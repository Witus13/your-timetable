<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-route/app-route.html">

<link rel="import" href="../bower_components/iron-media-query/iron-media-query.html">

<link rel="import" href="../bower_components/iron-resizable-behavior/iron-resizable-behavior.html">

<link rel="import" href="../bower_components/neon-animation/neon-animations.html"><!-- Pick only nescessary ones -->
<link rel="import" href="../bower_components/neon-animation/neon-animated-pages.html">

<dom-module id="yta-shell">
  <template>
    
    <style>
      neon-animated-pages, neon-animated-pages > * {
        /* --layout-fit */
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      }
    </style>
    
    <app-location route="{{route}}" use-hash-as-path></app-location>
    <app-route route="{{route}}"
               pattern="/:page"
               data="{{routeData}}"
               tail="{{tail}}"></app-route>
    
    <iron-media-query query="(max-width: 960px)"
                      query-matches="{{smallLayout}}"></iron-media-query>
    
    <neon-animated-pages selected="{{routeData.page}}" attr-for-selected="id">
      <yta-main-view id="app" small-layout="{{!smallLayout}}"></yta-main-view> <!-- Due to mistakes in yta-main code this needs to be negative -->
      <yta-help-page id="help" route="{{tail}}" small-layout="{{smallLayout}}"></yta-help-page>
    </neon-animated-pages>
  </template>
  <script>
    Polymer({
      is: 'yta-lazy-pages',
      
      observers: [
        'importPage(routeData.page)'
      ],
      
      attached: function() {
        if(!this.route.path) {
          this.set('route.path', '/app')
        }
      },
      
      importPage: function(page) {
        if(page == 'app') {
          if(!Polymer.isInstance(this.$.app)) {
            this.importHref('src/yta-main-view.html', null, null, true)
          }
        } else if(page == 'help') {
          if(!Polymer.isInstance(this.$.help)) {
            this.importHref('src/yta-help-page.html', null, null, true)
          }
        }
      }
    })
  </script>
</dom-module>