<link rel="import" href="/bower_components/polymer/polymer.html">

<link rel="import" href="/bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">

<link rel="import" href="/bower_components/paper-item/paper-item.html">
<link rel="import" href="/bower_components/paper-icon-button/paper-icon-button.html">

<dom-module id="paper-expansion-panel">
  <template>
    <style>
  
      :host {
        --paper-item-focused-before: {
          background: none;
        };
      }
      
      paper-icon-button {
        color: rgba(0,0,0,0.38);
        --paper-icon-button-ink-color: black;
        right: -6px;
      }
      
      .rotateable[triggered] {
        transition: transform 200ms cubic-bezier(0.4, 0.0, 0.2, 1);;
      }
      
      .rotateable {
        transform: rotate(0deg);
      }
      
      .rotateable.rotated {
        transform: rotate(180deg);
      }
      
      .spacer {
        ms-flex: 1 1 0.000000001px;
        -webkit-flex: 1;
        flex: 1;
        -webkit-flex-basis: 0.000000001px;
        flex-basis: 0.000000001px;
      }
    
    </style>
    
    <paper-item role="menuitem" on-tap="toggleCollapse" tabindex="-1">
      <div>[[headerTitle]]</div>
      <template is="dom-if" if="[[headerContent]]">
        <div class="secondary">[[headerContent]]</div>
      </template>
      <div class="spacer"></div>
      <paper-icon-button icon="arrow-drop-down"
                         class="rotateable"></paper-icon-button>
    </paper-item>
    <iron-collapse>
      <div>
        <slot></slot>
      </div>
    </iron-collapse>
  </template>
  
  <script>
    Polymer({
      is: 'paper-expansion-panel',
      
      properties: {
        
        headerTitle: {
          type: String,
          reflectToAttribute: "true"
        },
        
        headerContent: {
          type: String,
          reflectToAttribute: "true"
        }
        
      },
      
      toggleCollapse: function() {
        this.$$('iron-collapse').toggle();
        const button = this.$$('paper-icon-button');
        if(!button.hasAttribute('triggered')) {
          button.setAttribute('triggered', true)
        }
        button.toggleClass('rotated');
      }
    })
  </script>
</dom-module>